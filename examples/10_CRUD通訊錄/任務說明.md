# 📇 CRUD 通訊錄任務

## 🎯 任務目標

學習如何用自然語言讓 AI 幫你建立一個完整的「通訊錄管理系統」，並連接免費雲端資料庫，實現真正的資料永久儲存。

**什麼是 CRUD？**

| 縮寫 | 英文 | 中文 | 通訊錄範例 |
|------|------|------|------------|
| **C** | Create | 新增 | 新增一位聯絡人 |
| **R** | Read | 讀取 | 查看聯絡人清單 |
| **U** | Update | 更新 | 修改聯絡人資料 |
| **D** | Delete | 刪除 | 刪除一位聯絡人 |

> 💡 **為什麼學這個很重要？**
> CRUD 是所有資料管理系統的基礎，無論是客戶管理、庫存系統、訂單管理，都是 CRUD 的延伸應用！

---

## 🗄️ 免費雲端資料庫介紹

### 為什麼需要雲端資料庫？

| 本地儲存（CSV、JSON） | 雲端資料庫 |
|------------------------|------------|
| ❌ 關閉程式資料可能遺失 | ✅ 資料永久儲存 |
| ❌ 只能單機使用 | ✅ 多人協作共用 |
| ❌ 難以備份和還原 | ✅ 自動備份 |
| ❌ 無法遠端存取 | ✅ 隨時隨地存取 |

### 🌟 推薦平台：Supabase（完全免費！）

**Supabase** 是一個開源的 Firebase 替代方案，基於 PostgreSQL 資料庫。

**免費方案包含**：
- ✅ **500 MB** 資料庫儲存空間
- ✅ **無限** API 請求
- ✅ **50,000** 月活躍用戶
- ✅ **1 GB** 檔案儲存
- ✅ 自動產生 REST API
- ✅ 即時資料同步功能

> ⚠️ **注意**：免費方案專案閒置超過 7 天會暫停，重新訪問即可恢復。

### 其他免費資料庫選項

| 平台 | 類型 | 免費額度 | 適合用途 |
|------|------|----------|----------|
| **Supabase** | PostgreSQL | 500 MB / 無限 API | 完整應用開發（推薦）|
| **Firebase** | NoSQL | 1 GB / 5萬讀取/天 | 即時應用、行動 App |
| **Airtable** | 表格式 | 1,000 筆 / 1 GB | 簡單資料管理 |
| **MongoDB Atlas** | NoSQL | 512 MB | 彈性資料結構 |
| **PlanetScale** | MySQL | 5 GB | 大型專案 |

---

## 📝 Supabase 設定步驟

### 步驟 1：註冊帳號

```
1️⃣ 前往 https://supabase.com
2️⃣ 點擊右上角「Start your project」
3️⃣ 使用 GitHub 帳號登入（推薦！一鍵快速）
4️⃣ 授權 Supabase 存取你的 GitHub
```

### 步驟 2：建立專案

```
1️⃣ 點擊「New Project」
2️⃣ 填寫專案資訊：
   - Name：填「contacts-app」
   - Database Password：設定密碼（請記住！）
   - Region：選擇「Northeast Asia (Tokyo)」
   
3️⃣ 點擊「Create new project」
4️⃣ 等待 2-3 分鐘專案建立完成
```

### 步驟 3：建立資料表

```
1️⃣ 進入專案後，點擊左側「Table Editor」
2️⃣ 點擊「Create a new table」
3️⃣ 填寫表格資訊：
   - Name：contacts
   - ☑️ Enable Row Level Security (RLS) - 取消勾選（教學用）
   
4️⃣ 新增欄位（點擊「Add column」）：

   | 欄位名稱 | 類型 | 預設值 | 說明 |
   |----------|------|--------|------|
   | id | int8 | (自動) | 主鍵，自動產生 |
   | name | text | - | 姓名 |
   | phone | text | - | 電話 |
   | email | text | - | Email |
   | company | text | - | 公司 |
   | notes | text | - | 備註 |
   | created_at | timestamptz | now() | 建立時間 |

5️⃣ 點擊「Save」儲存
```

### 步驟 4：取得 API 金鑰

```
1️⃣ 點擊左側「Project Settings」（齒輪圖示）
2️⃣ 點擊「API」
3️⃣ 複製以下資訊（稍後會用到）：
   
   📋 Project URL：https://xxxxx.supabase.co
   📋 anon public key：eyJhbG...（很長的一串）
```

> ⚠️ **重要**：API 金鑰要妥善保管，不要公開分享！

---

## 💬 範例對話

### 情境 1：建立基本通訊錄介面

**你可以這樣說：**

```
我想用 Streamlit 做一個通訊錄管理系統，連接 Supabase 資料庫。
功能需求：
- 新增聯絡人（姓名、電話、Email、公司、備註）
- 顯示所有聯絡人列表
- 可以編輯聯絡人資料
- 可以刪除聯絡人

請幫我完成完整的程式碼，包含 Supabase 連接設定。
```

**AI 會幫你產生**：
- 🤖 完整的 Streamlit 應用程式碼
- 🤖 Supabase 連接設定
- 🤖 CRUD 四大功能實作
- 🤖 友善的使用者介面

---

### 情境 2：加入搜尋功能

**你可以這樣說：**

```
我想在通訊錄加上搜尋功能：
- 可以用姓名搜尋
- 可以用公司搜尋
- 可以用電話搜尋
- 搜尋結果即時顯示
```

---

### 情境 3：加入分類標籤

**你可以這樣說：**

```
我想幫聯絡人加上分類標籤：
- 可以選擇：家人、朋友、同事、客戶、其他
- 可以按照分類篩選聯絡人
- 顯示各分類的聯絡人數量
```

---

### 情境 4：匯出功能

**你可以這樣說：**

```
我想加入匯出功能：
- 可以把所有聯絡人匯出成 CSV
- 可以把所有聯絡人匯出成 Excel
- 下載按鈕要放在頁面右上角
```

---

### 情境 5：批次匯入

**你可以這樣說：**

```
我想加入批次匯入功能：
- 讓使用者上傳 CSV 或 Excel 檔案
- 自動識別欄位對應
- 預覽要匯入的資料
- 確認後批次新增到資料庫
```

---

## 💬 完整對話範例

```
👤：我想用 Streamlit 做一個通訊錄，連接 Supabase 資料庫
🤖：好的！請提供你的 Supabase 專案資訊：
    - Project URL
    - API Key
    我會幫你建立完整的通訊錄系統。

👤：URL 是 https://xxxxx.supabase.co，Key 是 eyJhbG...
🤖：（生成完整的 Streamlit 程式碼，包含：
    - 資料庫連接設定
    - 新增聯絡人表單
    - 聯絡人列表顯示
    - 編輯和刪除功能）

👤：可以加上搜尋功能嗎？
🤖：（加入即時搜尋功能，可按姓名、電話、公司搜尋）

👤：我想讓介面更好看一點
🤖：（美化介面：
    - 加入側邊欄放功能選單
    - 使用卡片式顯示聯絡人
    - 加入圖示和顏色標記）

👤：可以部署到網路上嗎？
🤖：（準備 requirements.txt 和部署說明，
    教你部署到 Streamlit Cloud）
```

---

## 🎓 學到的技巧

完成這個任務後，你會學到：

1. **資料庫概念**
   - 什麼是資料表（Table）
   - 什麼是欄位（Column）和資料列（Row）
   - 什麼是主鍵（Primary Key）

2. **API 操作**
   - 如何使用 API 新增資料（POST）
   - 如何使用 API 讀取資料（GET）
   - 如何使用 API 更新資料（PATCH）
   - 如何使用 API 刪除資料（DELETE）

3. **雲端部署**
   - 如何設定環境變數（保護 API 金鑰）
   - 如何部署到 Streamlit Cloud
   - 如何讓其他人使用你的應用

4. **程式設計模式**
   - 表單驗證（確保資料正確）
   - 錯誤處理（處理網路問題）
   - 狀態管理（記住使用者操作）

---

## 📂 測試資料說明

資料夾中提供了：

| 檔案 | 說明 |
|------|------|
| `sample_contacts.csv` | 10 筆範例聯絡人資料 |
| `sample_contacts.json` | JSON 格式的範例資料 |
| `README.md` | 測試資料使用說明 |

---

## 🎯 挑戰任務

### 🥇 初級挑戰
- [ ] 成功連接 Supabase 資料庫
- [ ] 完成新增聯絡人功能
- [ ] 顯示所有聯絡人列表
- [ ] 完成刪除聯絡人功能

### 🥈 中級挑戰
- [ ] 加入搜尋功能
- [ ] 加入編輯聯絡人功能
- [ ] 加入聯絡人分類標籤
- [ ] 美化介面（卡片式顯示）

### 🥉 高級挑戰
- [ ] 加入批次匯入 CSV/Excel 功能
- [ ] 加入匯出功能
- [ ] 部署到 Streamlit Cloud
- [ ] 加入使用者登入功能（Supabase Auth）

---

## 🌟 小技巧

### 安全性提醒

**❌ 不要這樣做**：
```python
# 把 API 金鑰直接寫在程式碼裡
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**✅ 應該這樣做**：
```python
# 使用環境變數
import os
SUPABASE_KEY = os.environ.get("SUPABASE_KEY")
```

```
# 在 Streamlit Cloud 設定 Secrets
# 或在 .env 檔案中設定（不要上傳到 GitHub！）
```

### 如何描述 CRUD 需求

**範例 1：新增功能**
```
我想要一個表單，輸入姓名、電話、Email 後，
點擊「新增」按鈕，資料會存到 Supabase 的 contacts 表格
```

**範例 2：讀取功能**
```
我想顯示所有聯絡人，用表格方式呈現，
每列顯示：姓名、電話、Email、公司
可以按照姓名排序
```

**範例 3：更新功能**
```
點擊聯絡人的「編輯」按鈕，
會跳出編輯表單，可以修改資料，
修改完按「儲存」，資料會更新到資料庫
```

**範例 4：刪除功能**
```
點擊聯絡人的「刪除」按鈕，
會先顯示確認對話框：「確定要刪除 XXX 嗎？」
確認後才真的刪除，避免誤刪
```

---

## 🚀 進階功能

### 即時同步

```
我想讓通訊錄支援多人同時使用，
當一個人新增聯絡人，其他人的畫面會自動更新
```

### 歷史記錄

```
我想記錄每次的操作歷史：
- 誰在什麼時間新增了哪位聯絡人
- 誰在什麼時間修改了什麼資料
- 誰在什麼時間刪除了哪位聯絡人
```

### 資料驗證

```
我想加入資料驗證：
- 電話必須是數字，長度 10 位
- Email 必須符合電子郵件格式
- 姓名不可以空白
不符合的話顯示錯誤提示
```

---

## 🔗 相關資源

- [Supabase 官方文件](https://supabase.com/docs)
- [Supabase Python Client](https://supabase.com/docs/reference/python/introduction)
- [Streamlit 文件](https://docs.streamlit.io/)

---

## ❓ 常見問題

### Q：Supabase 免費方案真的夠用嗎？

**A**：對於學習和小型專案絕對夠用！
- 500 MB 可以儲存超過 10 萬筆聯絡人
- 無限 API 請求，不用擔心用量
- 等專案長大再考慮升級

### Q：API 金鑰會不會被盜用？

**A**：只要正確使用就很安全：
1. 使用環境變數存放金鑰
2. 開啟 Row Level Security (RLS) 保護
3. 不要把金鑰上傳到公開的 GitHub

### Q：可以用手機存取嗎？

**A**：可以！Streamlit 應用是響應式設計，
部署後在手機瀏覽器也能正常使用。

### Q：資料會不會不見？

**A**：Supabase 提供自動備份功能，
免費方案也有，資料相對安全。
但建議重要資料還是定期匯出備份。

---

記住：**掌握 CRUD，就掌握了資料管理的核心！** 📇
