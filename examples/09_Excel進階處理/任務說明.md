# 📊 Excel 進階處理任務

## 🎯 任務目標

學習如何用自然語言讓 AI 幫你處理複雜的 Excel 任務：敏感資料匿名化、多工作表合併。

---

## 📂 測試資料說明

資料夾中提供了測試檔案 `測試資料/attend.xlsx`：

| 工作表名稱 | 內容 | 說明 |
|------------|------|------|
| `員工名單` | 員工基本資料 | 含姓名、身分證字號等敏感個資（約 30 筆） |
| `計算0901` ~ `計算1028` | 每日出勤計算 | 20 個「計算」開頭的工作表 |

---

## 💬 範例對話

### 情境 1：敏感資料匿名化

**你可以這樣說：**

```
幫我處理 測試資料/attend.xlsx 檔案，把所有工作表中的敏感資料做匿名化處理：
- 姓名改成亂數生成的假名
- 身分證字號改成亂數生成的假號碼
要保持資料的關聯性（同一個人在不同工作表要對應相同的假資料）
```

**進階要求（可選）：**

```
幫我產生一份對照表，以便日後還原
```

```
假名要用中文名，身分證字號格式要正確（開頭字母 + 9 個數字）
```

💡 **重點技巧**：
- 要求「保持關聯性」確保同一人在不同工作表的假資料一致
- 可以要求產生對照表以便日後還原
- ⚠️ 敏感資料處理前記得先備份原檔！

---

### 情境 2：合併多個工作表

**你可以這樣說：**

```
幫我把 測試資料/attend.xlsx 裡所有「計算」開頭的工作表合併成一個
```

**進階要求（可選）：**

```
垂直合併，加上「來源工作表」欄位來標註資料來自哪個工作表
```

```
把合併後的資料也匯出成 CSV
```

```
只合併計算0901到計算0930的工作表（九月份的資料）
```

💡 **重點技巧**：
- 用「○○開頭」來描述篩選條件更直覺
- 合併時加入來源標記能追蹤資料出處
- CSV 匯出時注意編碼問題（建議使用 UTF-8 with BOM）

---

## 🎓 學到的技巧

1. **敏感資料處理**：保護個資同時維持資料可用性
2. **多工作表操作**：批次處理 Excel 中的多個工作表
3. **資料關聯性**：確保替換後資料的一致性
4. **格式轉換**：Excel 轉 CSV 的編碼處理

---

## 🚀 現在輪到你了！

開啟 Copilot Chat (`Ctrl+I` 或 `Cmd+I`)，試著對話：

### 練習 1：基礎匿名化

```
把 attend.xlsx 的員工名單工作表中的姓名和身分證換成假資料
```

### 練習 2：完整匿名化

```
把 attend.xlsx 所有工作表中的敏感資料都匿名化，保持關聯性
```

### 練習 3：工作表合併

```
把所有「計算」開頭的工作表垂直合併成一個，加上來源欄位
```

### 練習 4：匯出 CSV

```
合併後匯出成 CSV，使用 UTF-8 with BOM 編碼（讓 Excel 能正確開啟中文）
```

---

## 💡 提示

### 匿名化的對話技巧

✅ **好的描述**：
```
把姓名改成亂數中文假名，身分證改成符合格式的假號碼，同一個人在不同工作表要對應相同的假資料
```

❌ **不好的描述**：
```
把資料弄亂（太模糊，不知道要處理什麼）
```

### Excel 常見操作

| 操作類型 | 說明 | 範例 |
|----------|------|------|
| 匿名化 | 替換敏感資料 | 姓名→假名、身分證→假號碼 |
| 合併工作表 | 多個工作表合成一個 | 垂直合併、水平合併 |
| 篩選工作表 | 按名稱規則選擇 | 「計算」開頭、「2024」包含 |
| 格式轉換 | Excel 轉其他格式 | CSV、JSON、SQL |

---

## 🎯 挑戰任務

### 🥇 初級挑戰
- [ ] 把員工名單的姓名換成假名
- [ ] 合併兩個工作表

### 🥈 中級挑戰
- [ ] 完整匿名化所有工作表，保持關聯性
- [ ] 合併所有「計算」工作表並加上來源欄位

### 🥉 高級挑戰
- [ ] 先合併再匿名化再匯出 CSV（多步驟組合）
- [ ] 產生對照表並加密保存
- [ ] 建立可重複使用的匿名化工具

---

## 🔥 終極挑戰：組合多個步驟

試試看一次完成多個步驟：

```
先把 attend.xlsx 所有「計算」工作表合併，
然後對合併後的資料做敏感資料匿名化，
最後匯出成一個乾淨的 CSV 檔案
```

這就是 AI 輔助資料處理的威力 — 用自然語言描述複雜的多步驟任務！

---

> 💡 **記住**：處理敏感資料時，**安全第一**！
> 
> 永遠先備份原檔，確認匿名化結果符合預期再刪除原始資料。
